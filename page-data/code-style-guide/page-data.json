{"componentChunkName":"component---src-templates-blog-post-js","path":"/code-style-guide/","result":{"data":{"site":{"siteMetadata":{"title":"scraggo.com"}},"markdownRemark":{"id":"3e978bd6-391e-5a6a-a163-33e159f891b7","excerpt":"We all have opinions on what what coding best practices are and how code should be formatted. Recently, one of the teams I’ve been working on decided to add…","html":"<p>We all have opinions on what what coding best practices are and how code should be formatted. Recently, one of the teams I’ve been working on decided to add another member. I discovered that our coding styles were radically different. I decided to write some guidelines for our team to get us on the same page.</p>\n<p>I quickly realized that writing a style guide from scratch is a tall order. I’d already been using the Airbnb eslint rule-set, so I read <a href=\"https://github.com/airbnb/javascript\">Airbnb’s style guide</a> and found it to be an excellent jump-off point.</p>\n<p>I hope this style guide gives you some ideas. I <em>highly</em> encourage web development teams to create their own style guides and use tools similar to the ones we’ve recommended to unify their personal or team codebases.</p>\n<h2>Team Coding Style Guide</h2>\n<p>We strive for code quality in all the applications we build. For us, code quality encompasses the following principles:</p>\n<ul>\n<li>modern syntax</li>\n<li>best practices</li>\n<li>prefer open source</li>\n<li>readability</li>\n<li>testability</li>\n<li>maintainability</li>\n<li>scalability</li>\n</ul>\n<p>and more.</p>\n<p>Much of this is taken care of by a few tools.</p>\n<ol>\n<li>Linter - This tool automatically formats code and catches bad and/or dangerous code practices. We use the Airbnb ruleset * with some modifications. (* We’ll go into more detail below.)</li>\n<li>Code Climate - a coverage tool that analyzes the master branch and any PRs made to it. It will go further than the linter can by analyzing where code could benefit from removing repetition (following DRY - Don’t Repeat Yourself), nested conditional statements, and other bad practices.</li>\n</ol>\n<h2>Environment - Setting up the linter</h2>\n<p>For this project, we use yarn, not npm. (npm is fine in my personal opinion.)</p>\n<p>Extensions:</p>\n<ul>\n<li>prettier</li>\n<li>eslint</li>\n</ul>\n<p>Settings:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsonc\"><pre class=\"language-jsonc\"><code class=\"language-jsonc\">// To make sure prettier formats .js files as jsx:\n&quot;files.associations&quot;: {\n  &quot;\\*.js&quot;: &quot;javascriptreact&quot;\n}\n\n&quot;files.trimTrailingWhitespace&quot;: true,\n&quot;files.insertFinalNewline&quot;: true,\n&quot;files.trimFinalNewlines&quot;: true,\n\n&quot;editor.tabSize&quot;: 2,\n\n&quot;emmet.includeLanguages&quot;: {\n    &quot;javascript&quot;: &quot;javascriptreact&quot;\n  },\n\n&quot;[javascript]&quot;: {\n  &quot;editor.formatOnSave&quot;: false\n},\n&quot;eslint.alwaysShowStatus&quot;: true,\n&quot;eslint.autoFixOnSave&quot;: true,\n&quot;prettier.disableLanguages&quot;: [\n  &quot;js&quot;\n],</code></pre></div>\n<blockquote>\n<p>Getting set up: <a href=\"https://blog.echobind.com/integrating-prettier-eslint-airbnb-style-guide-in-vscode-47f07b5d7d6a\">Integrating Prettier + ESLint + Airbnb Style Guide in VSCode</a></p>\n<p><a href=\"https://www.youtube.com/watch?v=iEBaSjYaOWs&#x26;t=375s\">Airbnb Eslint for React - YouTube</a></p>\n<p><a href=\"https://www.youtube.com/watch?v=YIvjKId9m2c\">How to Setup VS Code + Prettier + ESLint - YouTube</a></p>\n<p><a href=\"https://www.youtube.com/watch?v=bfyI9yl3qfE&#x26;t=353s\">Add ESLint &#x26; Prettier to VS Code for a Create React App - YouTube</a></p>\n</blockquote>\n<h2>Syntax</h2>\n<p>Since we’re using React v16+ with create-react-app v2+, we can take advantage of transpiling code with Babel. ES6 (aka ES 2015) Javascript syntax provides excellent features to remove some of the ambiguities in pre ES6 code as well as make it much more readable.</p>\n<blockquote>\n<p>This article outlines many of its features: <a href=\"https://codeburst.io/es5-vs-es6-with-example-code-9901fa0136fc\">ES5 vs ES6 ( With example code ) – codeburst</a></p>\n</blockquote>\n<p>Some explicit mentions:</p>\n<ul>\n<li>Anonymous functions should <em>almost</em> always be written with the <code class=\"language-text\">() =&gt; {}</code> syntax. Use an implicit return whenever possible.</li>\n<li>\n<p>No need for <code class=\"language-text\">self = this</code>. We can bind and track execution context with the notation above or binding in the constructor. We prefer binding in the constructor.</p>\n<ul>\n<li>Read: <a href=\"https://medium.com/@charpeni/arrow-functions-in-class-properties-might-not-be-as-great-as-we-think-3b3551c440b1\">Arrow Functions in Class Properties Might Not Be As Great As We Think</a></li>\n</ul>\n</li>\n<li><strong>Always</strong> use <code class=\"language-text\">let</code> or <code class=\"language-text\">const</code> instead of <code class=\"language-text\">var</code>. <code class=\"language-text\">const</code> is preferred if you can avoid using <code class=\"language-text\">let</code>.</li>\n<li>Class syntax instead of <code class=\"language-text\">Class.prototype.method = ...</code> syntax</li>\n<li>Template strings instead of string concatenation.</li>\n<li><code class=\"language-text\">import</code> and <code class=\"language-text\">export</code> instead of <code class=\"language-text\">require</code> and <code class=\"language-text\">module.exports</code>.</li>\n<li>\n<p>Prefer destructuring:</p>\n<ul>\n<li>Use default values like so <code class=\"language-text\">const { idx = 5 } = this.state</code>. If <code class=\"language-text\">this.state.idx</code> is undefined, 5 will be assigned to <code class=\"language-text\">idx</code>. (One catch, if this.state.idx is null or false, it will not be assigned the default value.)</li>\n<li>You can rename a variable that might conflict with this syntax: <code class=\"language-text\">const { idx: idxOnState } = this.state</code>. You’d use it as <code class=\"language-text\">idxOnState</code> below within function scope.</li>\n</ul>\n</li>\n</ul>\n<h3>Some highlights from the Airbnb style guide</h3>\n<p>From object-curly-spacing to handling Javascript language edge cases, following the <a href=\"https://github.com/airbnb/javascript\">Airbnb JavaScript Style Guide</a> will keep your codebase in check. It’s impressively precise. They don’t hesitate to be definitive.</p>\n<p>Using their <a href=\"https://www.npmjs.com/package/eslint-config-airbnb\">eslint rules</a> for React projects has definitely improved the quality of our code. Reading the guide answered a lot of my nagging questions about some of their eslint rules (which can seem bizarrely restrictive.)</p>\n<p>In true open-source fashion, some of the rules have corresponding issues on github where developers discuss the necessity of the rule. (example: <a href=\"https://github.com/airbnb/javascript/issues/794\">https://github.com/airbnb/javascript/issues/794</a> )</p>\n<h4>Airbnb enforces ES6</h4>\n<p>The ES6 syntax I mentioned above can also largely be found in the Airbnb styleguide:</p>\n<ul>\n<li>spread and rest operators</li>\n<li>destructuring</li>\n<li>default parameters</li>\n<li>es6 class syntax</li>\n<li>7.6 Never use arguments, opt to use rest syntax … instead.</li>\n<li>10.2 Do not use wildcard imports. - this has bitten me before.</li>\n<li>23.5 Don’t save references to this. Use arrow functions or Function#bind.</li>\n</ul>\n<h4>Airbnb avoids some property and function edge cases</h4>\n<ul>\n<li>3.7 Do not call Object.prototype methods directly, such as hasOwnProperty, propertyIsEnumerable, and isPrototypeOf. - This eslint rule baffled me until I read this. Now, I use their <a href=\"https://www.npmjs.com/package/has\">‘has’ package</a>.</li>\n<li>7.12/13 Never mutate/reassign parameters.</li>\n<li>29.1 Use Number.isNaN instead of global isNaN. eslint: no-restricted-globals - I didn’t realize there was a better way!</li>\n</ul>\n<h4>Airbnb has some nice specifics I hadn’t considered before</h4>\n<ul>\n<li>7.9 Always put default parameters last.</li>\n<li>23.9 Acronyms and initialisms should always be all uppercased, or all lowercased.</li>\n</ul>\n<h3>Some rules we haven’t adopted</h3>\n<ul>\n<li>7.1 Use named function expressions instead of function declarations.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// good</span>\n<span class=\"token comment\">// lexical name distinguished from the variable-referenced invocation(s)</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">short</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">longUniqueMoreDescriptiveLexicalFoo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>While I like the idea, I agree with some of the commenters, why not just use the longer and more descriptive name?</p>\n<blockquote>\n<p>(Discussion: <a href=\"https://github.com/airbnb/javascript/issues/794\">https://github.com/airbnb/javascript/issues/794</a> )</p>\n</blockquote>\n<ul>\n<li>23.4 Do not use trailing or leading underscores. eslint: no-underscore-dangle</li>\n</ul>\n<p>Their reasoning makes perfect sense. However, I’m a fan of using <code class=\"language-text\">_</code> prefixing to denote to the developer that this property doesn’t need to be served to the front end. There are no illusions about it being “private” or “protected”, it’s just a simple way to differentiate properties inside a codebase.</p>\n<h2>Best practices</h2>\n<p>We follow the practices in these guides:</p>\n<blockquote>\n<p><a href=\"https://americanexpress.io/clean-code-dirty-code/\">Clean Code vs. Dirty Code: React Best Practices - American Express Technology</a></p>\n<p><a href=\"https://blog.bitsrc.io/how-to-write-better-code-in-react-best-practices-b8ca87d462b0\">How To Write Better Code in React – Bits and Pieces</a></p>\n</blockquote>\n<p>A few points that are really important to us:</p>\n<ul>\n<li>Keep code DRY - Don’t Repeat Yourself. If you can make something into a function, please do it. If you’re copying and pasting, refactor into a more abstract function that can be re-used.</li>\n<li>Write descriptive function and variable names (self-commenting)</li>\n<li>Add documentation above functions that need more explanation</li>\n</ul>\n<p>We follow a few basic principles coming from functional programming. Wherever possible, we keep functions pure, the data immutable, and prefer array methods like <code class=\"language-text\">map</code>, <code class=\"language-text\">filter</code>, and <code class=\"language-text\">reduce</code>.</p>\n<blockquote>\n<p><a href=\"https://opensource.com/article/17/6/functional-javascript\">Beginner’s guide to functional programming in JavaScript - Opensource.com</a></p>\n</blockquote>\n<p>There are exceptions where we may prefer for loops or non-functional principles:</p>\n<ul>\n<li>The dataset is very large</li>\n<li>There <em>must</em> be a side effect</li>\n</ul>\n<p>If these are the case, then it is documented with the code.</p>\n<h2>Git commit messages</h2>\n<p>We like having a readable, targeted, and descriptive git history.</p>\n<p>Put all related file changes in one commit with a descriptive message - ie. Avoid using <code class=\"language-text\">git add .</code> unless you’re sure that the message pertains to all the files.</p>\n<p>Add separate commits for unrelated files. When in doubt, make many, smaller commits.</p>\n<p>Check out <a href=\"/tech/git-commit-format-squash\">How to format and edit your git commit messages</a>.</p>\n<h2>Unit testing</h2>\n<p>Components should be written with testability in mind. We use Jest with Enzyme and aim for > 90% coverage with unit and integration tests.</p>\n<h2>JSDoc documentation</h2>\n<p>Where documentation is necessary above classes and functions, we follow the JSDoc syntax: <a href=\"https://en.wikipedia.org/wiki/JSDoc\">JSDoc - Wikipedia</a></p>\n<h2>Proptypes</h2>\n<p>Any props used in a component must be validated with the <code class=\"language-text\">prop-types</code> library. This article mentions the syntax we use for functional components:</p>\n<blockquote>\n<p><a href=\"https://codeburst.io/validating-props-easily-with-react-proptypes-96e80208207\">Validating Props easily with React PropTypes – codeburst</a></p>\n</blockquote>\n<p>For class / stateful components, we prefer this syntax:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Hello</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">static</span> propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n    age<span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">,</span>\n    bio<span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">static</span> defaultProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n    age<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n    bio<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Prefer open source before custom components</h2>\n<p>We prefer open source over custom components. We follow a POC (Proof of Concept) method when we are evaluating our custom code needs.</p>\n<p>Open source criteria:</p>\n<ul>\n<li>Well-maintained library by larger companies</li>\n<li>Addresses important issues like accessibility</li>\n<li>Has been beta tested by many users to get rid of first defects</li>\n<li>Includes unit testing with high coverage</li>\n</ul>\n<p>POC method</p>\n<ol>\n<li>Discuss our needs</li>\n<li>Gather options that may fit</li>\n<li>Put them into a smaller version of the project</li>\n<li>Discuss pros, cons</li>\n<li>Make decision</li>\n</ol>\n<p>If we decide to make a custom component, it should follow best practices and be able to be abstract enough to be adaptable for other purposes and use cases. It should be able to evolve with the project. It should also include unit tests with high coverage.</p>\n<h2>Styling</h2>\n<p>We use SASS for our project. We have a number of .scss files that contain CSS with some of the convenience that SCSS gives us.</p>\n<blockquote>\n<p><a href=\"https://sass-lang.com/guide\">Sass: Sass Basics</a></p>\n</blockquote>\n<h3>Adding a .scss file for a component</h3>\n<p>First, create a new file with the component (or other descriptive) name.</p>\n<p>There are a few mutually exclusive ways to go about adding styling to the project:</p>\n<ul>\n<li>SCSS can be loaded into components directly like so: <code class=\"language-text\">import &#39;./SearchResultCard.scss&#39;;</code>. This will be used in just this component, which is a nice way to keep things modular.</li>\n<li>SCSS can be loaded into the main stylesheet by adding an import to the <code class=\"language-text\">index.scss</code> file like so: <code class=\"language-text\">@import &#39;./scss/_media_queries.scss&#39;;</code>. The import order matters, if in doubt, put your import at the bottom.</li>\n</ul>\n<p>One or the other is up to the case at hand.</p>\n<h3>Targeting selectors - avoid using this syntax:</h3>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.element </span><span class=\"token punctuation\">{</span>\n  <span class=\"token selector\"><span class=\"token parent important\">&amp;</span>-child: </span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 32px<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Here, the <code class=\"language-text\">&amp;-child</code> is actually targeting the <code class=\"language-text\">.element-child</code> class. This is difficult to search for in a code base, so explicitly write out the selector instead of using the <code class=\"language-text\">&amp;</code> as shorthand.</p>\n<h2>Related Posts</h2>\n<ul>\n<li><a href=\"/tech/git-commit-format-squash\">How to format and edit your git commit messages</a></li>\n<li><a href=\"/tech/custom-type-checking-isnan\">Custom type checking - isNaN vs Number.isNaN</a></li>\n</ul>","fields":{"slug":"/code-style-guide/"},"frontmatter":{"author":"Dave Cohen","categories":["tech"],"date":"March 18, 2019","description":null,"tags":["JavaScript"],"title":"Using a Code Style Guide to Enforce Team Best Practices"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/code-style-guide/","previous":{"fields":{"slug":"/recruiters-and-junior-devs/"},"frontmatter":{"title":"Should junior developers work with recruiters?","type":"post"}},"next":{"fields":{"slug":"/custom-type-checking-isnan/"},"frontmatter":{"title":"Custom type checking - isNaN vs Number.isNaN","type":"post"}}}}}